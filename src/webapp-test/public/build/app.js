function _$1(e,t){return t}window.__defineTemplate=_$1;

function n$1(n){return _$1(n.name,(e=>i$1({builder:e},n.children)))}function t$1(e){return e&&"object"==typeof e&&"props"in e&&"type"in e}function i$1(e,n){if(null!=n)if(Array.isArray(n))for(const t of n)i$1(e,t);else if("string"==typeof n)e.builder.text(n);else if(t$1(n))if("string"==typeof n.type){const t=e.builder.beginChild(n.type);for(const e in n.props){if("children"==e)continue;const i=n.props[e];if("style"==e)i&&t.styles(i);else if("value"==e)t.value(i);else if("text"==e)t.text(i);else if("visible"==e)t.visible(i);else if("html"==e)t.html(i);else if("focus"==e)t.focus(i);else if("class"==e)t.class(i);else if("behavoir"==e){const e=Array.isArray(i)?i:[i];for(const n of e)t.behavoir(n);}else e.startsWith("on-")?t.on(e.substring(3),i):t.set(e,i);}i$1({builder:t},n.props.children),t.endChild();}else if(n.type.toString().startsWith("class ")){const t=new n.type(n.props);e.builder.content(t);}else {i$1(e,n.type({...n.props,context:e}));}else "function"==typeof n&&e.builder.text(n);}window.__createElement=function(e,t,...i){return "function"==typeof e&&e==n$1?e({...t,children:i}):{type:e,props:{...t,children:i}}};

function e(e){return e&&"object"==typeof e&&"function"==typeof e.get&&"function"==typeof e.subscribe}function t(e){return Array.isArray(e)&&"subscribe"in e&&"function"==typeof e.subscribe}function n(e,t){if(e&&0!=e.length)for(let n=e.length-1;n>=0;n--)t(e[n]);}function s(e){if(t(e))return;let n;const s=e;return s.raise=e=>{n&&n.forEach((t=>e(t)));},s.subscribe=function(e){n||(n=[]);return -1==n.indexOf(e)&&n.push(e),e},s.unsubscribe=function(e){if(!n)return;const t=n.indexOf(e);-1!=t&&n.splice(t,1);},e.reverse=function(){const e=Array.prototype.reverse.call(this);return this.raise((e=>e.onReorder&&e.onReorder())),e},e.sort=function(...e){const t=Array.prototype.sort.call(this,...e);return this.raise((e=>e.onReorder&&e.onReorder())),t},e.push=function(...e){const t=this.length,n=Array.prototype.push.call(this,...e);for(let e=t;e<this.length;e++)this.raise((t=>t.onItemAdded&&t.onItemAdded(this[e],e,"add")));return this.raise((e=>e.onChanged&&e.onChanged())),n},e.shift=function(){const e=Array.prototype.shift.call(this);return void 0!==e&&(this.raise((t=>t.onItemRemoved&&t.onItemRemoved(e,0,"remove"))),this.raise((e=>e.onChanged&&e.onChanged()))),e},e.pop=function(){const e=Array.prototype.pop.call(this);return void 0!==e&&(this.raise((t=>t.onItemRemoved&&t.onItemRemoved(e,this.length,"remove"))),this.raise((e=>e.onChanged&&e.onChanged()))),e},e.splice=function(e,t,...n){const s=Array.prototype.splice.call(this,e,t,...n);if(0==e&&t>=this.length&&(!n||0==n.length)&&this.raise((e=>e.onClear&&e.onClear())),t>0)for(let n=0;n<t;n++)this.raise((t=>t.onItemRemoved&&t.onItemRemoved(s[n],n+e,"remove")));if(n.length>0)for(let t=0;t<n.length;t++)this.raise((s=>s.onItemAdded&&s.onItemAdded(n[t],t+e,"insert")));return this.raise((e=>e.onChanged&&e.onChanged())),s},s}const i=Symbol("Props"),r$1=Symbol("@typeName");function o(e){let t=e.name;if(!t){const n=/function\s([^(]{1,})\(/.exec(e.toString());t=n&&n.length>1?n[1].trim():"";}return t}function l$1(e){if(!e)return;const t=typeof e;let n="object"==t?e[r$1]:void 0;if(!n){if("function"==t)n=o(e);else if("object"==t){const t=e.constructor;t&&(n=l$1(t));}else n=t;"object"==t&&(e[r$1]=n);}return n}let a$1 = class a{_handlers;_descriptor;constructor(e,t){this._descriptor=e,this.name=t;}get(){return this._descriptor.get?this._descriptor.get():this._descriptor.value}set(e){const t=this.get();this._descriptor.set?this._descriptor.set(e):this._descriptor.value=e,t!==e&&this._handlers&&n(this._handlers,(n=>n(e,t)));}notifyChanged(){const e=this.get();n(this._handlers,(t=>t(e,void 0)));}subscribe(e){this._handlers||(this._handlers=[]);return -1==this._handlers.indexOf(e)&&this._handlers.push(e),e}unsubscribe(e){if(!this._handlers)return;const t=this._handlers.indexOf(e);-1!=t&&this._handlers.splice(t,1);}name};function h$1(e,t,n,s){const i=d$1(e,t);if(i)return i;const r=u$1(e,t,n);return void 0!==s&&void 0===r.get()&&r.set(s),r}function d$1(e,t){if(i in e)return e[i][t]}function c$1(e,t){e.set(t.get()),t.subscribe((t=>e.set(t))),e.subscribe((e=>t.set(e)));}function u$1(e,t,n){let s=Object.getOwnPropertyDescriptor(e,t);return s||(console.warn("'",t,"' not defined in ",l$1(e)),s={}),n||(n=new a$1(s,t)),i in e||Object.defineProperty(e,i,{value:{},enumerable:!1,writable:!1}),e[i][t]=n,Object.defineProperty(e,t,{get:()=>n.get(),set:e=>n.set(e)}),n}const m$1=Symbol("isProxy");let p$1 = class p{_bindings=[];_modelBinders=[];constructor(e){this.updateModel(e);}register(e){this._modelBinders.push(e);}getBindValue(e){return "function"==typeof e?e(this.model):e}getBindingValue(e,t=!0){return e.value(this.createProxy(this.model,((n,s)=>(t&&this.subscribe(n,s,e),!0))))}bind(e,t){if("function"==typeof e){const n={value:e,action:t,subscriptions:[],lastValue:void 0,suspend:0};this._bindings.push(n);const s=this.getBindingValue(n);n.action(s,void 0,!1),n.lastValue=s;}else t(e,void 0,!1);}unsubscribe(e,n){e.subscriptions.forEach((e=>{t(e.source)&&e.source.unsubscribe(e.handler),e.property&&e.property.unsubscribe(e.handler);})),n&&e.lastValue&&(e.action(null,e.lastValue,!0,!0),e.lastValue=null),e.subscriptions=[];}subscribe(e,n,s){for(let t=0;t<s.subscriptions.length;t++){const i=s.subscriptions[t];if(i.source==e&&i.name==n)return}if(t(e)){const t={onChanged:()=>{const e=this.getBindingValue(s);e!=s.lastValue&&(s.action(e,s.lastValue,!0),s.lastValue=e);}};e.subscribe(t);}const i=Object.getOwnPropertyDescriptor(e,n);if(!i&&Array.isArray(e)||!i.writable&&!i.set)return void console.warn("Property ",n," for object ",e," not exists or is not writeable.");const r=h$1(e,n),o=(i,r)=>{if(!(s.suspend>0)){s.suspend++;try{const o=this.getBindingValue(s,!1);if(o==s.lastValue)return;this.unsubscribe(s,!1),this.getBindingValue(s),s.action(o,s.lastValue,!0),t(e)&&(e.raise((e=>e.onChanged&&e.onChanged())),e.raise((e=>e.onItemReplaced&&e.onItemReplaced(i,r,parseInt(n))))),s.lastValue=o;}finally{s.suspend--;}}};r.subscribe(o),s.subscriptions.push({source:e,property:r,name:n,handler:o});}getBindingProperty(e){if("function"!=typeof e)return null;let t;return e(this.createProxy(this.model,((e,n)=>(t={obj:e,propName:n},!0)))),t&&t.obj?h$1(t.obj,t.propName):void 0}findParentModel(){let e=this.parent;for(;e;){if(e.model!=this.model)return e.model;e=e.parent;}}createProxy(e,n){if(!e||"object"!=typeof e)return e;const i={};return Array.isArray(e)&&(t(e)||s(e)),new Proxy(e,{get:(t,s)=>s===m$1||("@parent"===s?this.createProxy(this.findParentModel(),n):"symbol"==typeof s||"function"==typeof t[s]||Array.isArray(e)&&"length"===s?t[s]:(n(e,s)?i[s]=this.createProxy(t[s],n):i[s]=t[s],i[s])),set:(t,s,r)=>{if(t[s]!=r)return "symbol"==typeof s?t[s]:(n(e,s)?i[s]=this.createProxy(t[s],n):i[s]=t[s],t[s]=r,!0)}})}cleanBindings(e){this._bindings.forEach((t=>this.unsubscribe(t,e))),this._modelBinders.forEach((t=>t.cleanBindings(e))),this._modelBinders=[],this._bindings=[];}updateModel(e){this.model=e,n(this._bindings,(e=>{const t=this.getBindingValue(e);e.lastValue!=t&&(e.action(t,e.lastValue,!0),e.lastValue=t);})),n(this._modelBinders,(t=>t.updateModel(e)));}model;parent};function f(e){return e&&"object"==typeof e&&"nodes"in e}const b$1={},g={};function _(e,t){return b$1[e]=t,t}class E extends p$1{_endElement;_startElement;_lastElement;_childCount=0;_updateCount=0;_updateNode=null;constructor(e,t,n){super(e),this.parent=n,this.element=t,t.namespaceURI&&"http://www.w3.org/1999/xhtml"!=t.namespaceURI&&(this.namespace=t.namespaceURI);}beginTemplate(e,t,n="after",s){const i=new E(e,this.element,this);return i._lastElement=this._lastElement,i.begin(t,n,s),"explicit"==this.inlineMode&&(i.isInline=this.isInline,i.inlineMode="inherit"),i}endTemplate(e){e.end(),e.element==this.element&&(this._lastElement=e._lastElement);}beginUpdate(){0==this._updateCount&&this.element.parentNode&&(this._updateNode=document.createTextNode(""),this.element.parentNode.replaceChild(this._updateNode,this.element)),this._updateCount++;}endUpdate(){this._updateCount--,0==this._updateCount&&this._updateNode&&(this._updateNode.parentNode.replaceChild(this.element,this._updateNode),this._updateNode=null);}begin(e,t,n){return this._startElement=n?document.createComment("begin-"+n):document.createTextNode(""),e?"after"==t?e.nextSibling?e.parentNode.insertBefore(this._startElement,e.nextSibling):e.parentNode.appendChild(this._startElement):"before"==t?e.parentNode.insertBefore(this._startElement,e):"inside"==t&&e.appendChild(this._startElement):this.appendChild(this._startElement),this._lastElement=this._startElement,this}end(){if(!this._endElement)return this._startElement.nodeType==Node.COMMENT_NODE?this._endElement=document.createComment(this._startElement.textContent.replace("begin-","end-")):this._endElement=document.createTextNode(""),this.appendChild(this._endElement),this}clear(e=!1){this._childCount=0,this._endElement||(console.warn("Missing end element: "+this.model),this.end());let t=this._endElement;for(;;){let n=!0;t!=this._startElement&&t!=this._endElement||e||(n=!1);const s=t.previousSibling;if(n&&n&&t.parentNode.removeChild(t),t==this._startElement)break;t=s;}return e?(this._endElement=null,this._startElement=null,this._lastElement=null):this._lastElement=this._startElement,this.cleanBindings(!0),this}appendChild(e){return this._lastElement&&this._lastElement.parentNode?this._lastElement.nextSibling?this._lastElement.parentNode.insertBefore(e,this._lastElement.nextSibling):this._lastElement.parentNode.appendChild(e):this.element.appendChild(e),this._lastElement=e,this}foreach(e,n){let s=[];const i=this.loadTemplate(n),r=document.createTextNode("");this.appendChild(r);const o={onClear:()=>{s.forEach((e=>e.clear(!0))),s=[];},onItemRemoved:(e,t,n)=>{"replace"!=n&&"clear"!=n&&(s[t].clear(!0),s.splice(t,1));},onItemSwap:(e,t)=>{},onItemReplaced:(e,t,n)=>{s[n].updateModel(e);},onReorder:()=>{const t=this.getBindValue(e);o.onClear();for(let e=0;e<t.length;e++)o.onItemAdded(t[e],e,"add");},onItemAdded:(e,t,n)=>{if("replace"==n)return;let o;t==s.length?(o=0==t?this.beginTemplate(e,r,"after",this.createMarker(e)):this.beginTemplate(e,s[t-1]._endElement,"after",this.createMarker(e)),s.push(o)):(o=this.beginTemplate(e,s[t]._startElement,"before",this.createMarker(e)),s.splice(t,0,o)),o.index=t,i(o),this.endTemplate(o);}};return this.bind(e,((e,n,s,i)=>{if(!i){if(this.beginUpdate(),s&&o.onClear(),t(n)&&n.unsubscribe(o),e){t(e)&&e.subscribe(o);for(let t=0;t<e.length;t++)o.onItemAdded(e[t],t,"add");}this.endUpdate();}})),this}if(e,t,n){const s=this.beginTemplate(this.model);return this.register(s),this.bind(e,((e,i,r,o)=>{o||(r&&s.clear(),e?s.template(t):n&&s.template(n));})),this.endTemplate(s),this}replaceContent(e){if(this.isInline)throw new Error("'replaceContent' not supported in inline elements");this.clear();for(const t of e)this.appendChild(t);}extractContent(){const e=[];for(const t of this.element.childNodes)t!=this._startElement&&t!=this._endElement&&e.push(t);return e}content(e,t=!1){const n=this.beginTemplate(void 0,void 0,void 0,this.createMarker(e));return n.isInline=t,n.inlineMode="explicit",this.bind(e,((e,t,s,i)=>{if(!i){if(this.beginUpdate(),!n.isInline&&f(e)&&e.nodes&&!0===e.isCacheEnabled)n.replaceContent(e.nodes);else {if(t&&e&&t.template==e.template)n.updateModel(e);else if(s&&n.clear(),e){const t=this.templateFor(e);if(!t)throw new Error("Template '"+e.template+"' not found.");n.updateModel(e),t(n);}f(e)&&!0===e.isCacheEnabled&&(e.nodes=this.extractContent());}this.endUpdate();}})),this.endTemplate(n),this}templateFor(e){if("string"==typeof e||"number"==typeof e)return this.loadTemplate("Text");if("object"==typeof e&&"template"in e)return this.loadTemplate(e.template);throw new Error("cannot determine template for model")}loadTemplate(e){if("string"==typeof e){const t=b$1[e];return t||console.error("Template ",e," not found."),t}return e}template(e,t){const n=this.loadTemplate(e);if(t){const e=this.beginTemplate(void 0,void 0,void 0,this.createMarker(t,"template"));this.bind(t,((t,s,i,r)=>{r||(e.updateModel(t),i||n(e));})),this.endTemplate(e);}else n(this);return this}exec(e){return e(this),this}beginChild(e,t){if(this.isInline&&this._childCount>0)throw new Error("In inline mode you must have a single root element for your template");const n=this.isInline&&e.toUpperCase()==this.element.tagName?this.element:this.createElement(e,t),s=new y$1(this.model,n,this);return n==this.element&&(s._lastElement=this._lastElement),this.register(s),this._childCount++,s}child(e,t,n){const s=new E(this.model,this.createElement(e,n),this);return this.register(s),"function"==typeof t?t(s):s.attribs(t),this.appendChild(s.element),this}set(e,t){return this.bind(t,(t=>{null!=t?t instanceof Promise?t.then((t=>this.element.setAttribute(e,t))):this.element.setAttribute(e,t):this.element.removeAttribute(e);})),this}on(e,t){return this.element.addEventListener(e,(e=>t(this.model,e))),this}class(e,t){if(t&&"string"==typeof e){const n=e?e.split(" "):[];this.bind(t,(e=>{e?n.forEach((e=>this.element.classList.add(e))):n.forEach((e=>this.element.classList.remove(e)));}));}else this.bind(e,((e,t)=>{t&&t.split(" ").forEach((e=>this.element.classList.remove(e))),e&&e.split(" ").forEach((e=>this.element.classList.add(e)));}));return this}visible(e){return this.bind(e,((e,t,n,s)=>{s||(e?(this.element.classList.add("visible"),this.element.classList.remove("hidden")):(this.element.classList.add("hidden"),this.element.classList.remove("visible")));})),this}text(e){const t=document.createTextNode("");return this.appendChild(t),this.bind(e,(e=>t.textContent=e)),this}html(e){return this.bind(e,(e=>this.element.innerHTML=e)),this}focus(e){const t=this.getBindingProperty(e);return t&&(this.element.addEventListener("focus",(e=>t.set(!0))),this.element.addEventListener("focusout",(e=>t.set(!1)))),this.bind(e,(e=>{e&&document.activeElement!=this.element&&this.element.focus();})),this}value(e){const t=this.element,n=this.getBindingProperty(e);return n&&("INPUT"==t.tagName||"TEXTAREA"==t.tagName?"checkbox"==t.type||"radio"==t.type?t.addEventListener("change",(e=>{n.set(t.checked);})):(t.addEventListener("keyup",(e=>{n.set(t.value);})),t.addEventListener("change",(e=>{n.set(t.value);}))):"SELECT"==t.tagName&&t.addEventListener("change",(e=>{n.set(t.value);}))),"INPUT"!=t.tagName&&"TEXTAREA"!=t.tagName&&"SELECT"!=t.tagName||("checkbox"==t.type||"radio"==t.type?this.bind(e,(e=>t.checked=e)):this.bind(e,(e=>t.value=e||null))),this}style(e,t){return this.bind(t,(t=>this.element.style[e]=t)),this}behavoir(e){return "string"==typeof e?g[e]().attach(this.element,this.model):e.attach(this.element,this.model),this}styles(e){for(const t in e)this.bind(e[t],(e=>this.element.style[t]=e));return this}attribs(e){for(const t in e)this.set(t,e[t]);return this}debugger(){return this}createElement(e,t){return t||(t=this.namespace),t?document.createElementNS(t,e):document.createElement(e)}createMarker(e,t=""){}namespace=null;element=null;parent=null;isInline=!1;inlineMode="never";index=0}let y$1 = class y extends E{constructor(e,t,n){super(e,t,n);}endChild(){return this.parent.element!=this.element?this.parent.appendChild(this.element):this._lastElement&&(this.parent._lastElement=this._lastElement),this.parent}};function v(e,t,n){e.innerHTML="";const s=void 0===n?t.template:t;n||(n=t);const i=new E(n,e);i.begin(),i.loadTemplate(s)(i),i.end();}_("Text",(e=>e.text((e=>e)))),window.__defineTemplate=_;

function c(t){return t.toUpperCase()===t}function a(t){let e=0,n="";for(let s=0;s<t.length;s++){const o=t.charAt(s);switch(e){case 0:n+=o.toLowerCase(),c(o)&&"-"!=o||(e=1);break;case 1:c(o)&&"-"!=o&&(n+="-",e=0),n+=o.toLowerCase();}}return n}class l{constructor(t){this.options=t,this.bindOptions("style","template"),this.onChanged("style",(()=>this.updateClass())),this.updateClass();}onChanged(e,n){h$1(this,e).subscribe(n);}bindOptions(...t){if(this.options)for(const e of t){const t=e in this.options?this.options[e]:void 0;this.bind(e,t);}}bind(s,o){null===o&&void 0===o||(e(o)?c$1(h$1(this,s),o):this[s]=o);}updateClass(){this.className=[a(l$1(this)),...this.style??[]].flat().join(" ");}className;template;style;options}const d={Button:__defineTemplate('"Action"',(t=>{t.beginChild("button").behavoir("Ripple").class((t=>t.className)).on("click",(t=>t.executeAsync())).content((t=>t.content)).endChild();}))};class r extends l{constructor(t){super(t),this.bindOptions("content","executeAsync");}async executeAsync(){}content;template=d.Button}const h={Single:__defineTemplate('"PageHost"',(t=>{t.beginChild("main").class((t=>t.className)).beginChild("section").class("content").content((t=>t.current)).endChild().endChild();}))};class p extends l{_stack=[];_index;constructor(t){super(t),this.onChanged("current",(async(t,e)=>{e?.onClose&&e.onClose(),t.loadAsync&&await this.loadPageAsync(t),t?.onOpen&&t.onOpen();}));}async loadPageAsync(t){await t.loadAsync();}push(t){this._stack.push(this.current),this.current=t;}pop(){this.current=this._stack.pop();}canGoBack(){}current;template=h.Single}const u={Simple:__defineTemplate('"PageHost"',(t=>{t.beginChild("div").class((t=>t.className)).beginChild("header").beginChild("h1").text((t=>t.title)).endChild().endChild().beginChild("section").class("body").content((t=>t.content)).endChild().endChild();}))};class C extends l{constructor(t){super(t),this.bindOptions("title","content","route","name");}async loadAsync(){}onOpen(){}onClose(){}title;content;route;name;template=u.Simple}class m{attach(t,e){alert(t);}detach(t,e){}}g.Ripple=()=>new m;class b{constructor(t){}runAsync(t){"string"==typeof t?t=document.querySelector(t):t||(t=document.body),v(t,this.pageHost);}pageHost=new p}function y(t){return window.addEventListener("load",(()=>{t.runAsync();})),t}

class SecondPage extends C {
    constructor() {
        super({
            name: "second",
            title: "Seconda Pagina",
            route: "/second",
            content: {
                text: "cazzo",
                template: (__defineTemplate("\"SecondPage\"", t => { t
    .beginChild("input").value(m => m.text).set("type","\"text\"").endChild()
    .beginChild("button").on("click", m => app.pageHost.pop()).text("Back").endChild();
}))
            }
        });
    }
}
const secondPage = new SecondPage();

class MainPage extends C {
    constructor() {
        super({
            name: "main",
            title: "Pagna Principale",
            route: "/",
            content: new r({
                content: "Click Me",
                executeAsync: async () => {
                    app.pageHost.push(secondPage);
                }
            })
        });
    }
}
const mainPage = new MainPage();

const app = y(new b());
app.pageHost.push(mainPage);

export { app };
//# sourceMappingURL=app.js.map
